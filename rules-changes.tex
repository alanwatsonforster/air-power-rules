%\newcommand{\thisversion}{All}
%\newcommand{\thisversion}{1A}
%\newcommand{\thisversion}{1B}
%\newcommand{\thisversion}{1C}
\newcommand{\thisversion}{2A}
%\newcommand{\thisversion}{2Z}

%\newcommand{\thissubversion}{}
\newcommand{\thissubversion}{\ Changes}
%\newcommand{\thissubversion}{\ Verbose Changes}

\newcommand{\thisrevision}{2024-02-13}

\renewcommand{\beforesectionnumber}{RULE\ }
\renewcommand{\aftersectionnumber}{ ---}
\renewcommand{\aftersubsectionnumber}{ ---}
\renewcommand{\aftersubsubsectionnumber}{ ---}
\newcommand{\rulename}{rule}
\newcommand{\Rulename}{Rule}
  
\usepackage{xstring}

\IfStrEq{\thisversion}{1A}{
    % The original first-edition rules without the official errata.
    \newcommand{\earlierversion}{}
    \newcommand{\earlierversions}{}
}{}
\IfStrEq{\thisversion}{1B}{
    % Incorporating the official errata published in APJ 24.
    \newcommand{\earlierversion}{1A}
    \newcommand{\earlierversions}{1A}
}{}
\IfStrEq{\thisversion}{1C}{
    % With additional changes from authoritative sources, including statements by JDW or FHâ€™s article in APJ 36.
    \newcommand{\earlierversion}{1B}
    \newcommand{\earlierversions}{1A1B}
}{}
\IfStrEq{\thisversion}{1D}{
    \newcommand{\earlierversion}{1C}
    \newcommand{\earlierversions}{1A1B1C}
}{}
\IfStrEq{\thisversion}{1E}{
    \newcommand{\earlierversion}{1C}
    \newcommand{\earlierversions}{1A1B1C1D}
}{}
\IfStrEq{\thisversion}{2A}{
    \newcommand{\earlierversion}{1E}
    \newcommand{\earlierversions}{1A1B1C1D1E}
}{}
\IfStrEq{\thisversion}{2B}{
    \newcommand{\earlierversion}{2A}
    \newcommand{\earlierversions}{1A1B1C1D1E2A}
}{}
\IfStrEq{\thisversion}{2Z}{
    \newcommand{\earlierversion}{2B}
    \newcommand{\earlierversions}{1A1B1C1D1E2A2B}
}{}

% These commands compare their first argument to \thisversion. If their first argument is an equal to, earlier than, or later than \thisversion, they evaluate their second argument. The first argument will normally be the version in which a change was made. The commands should be read as "if the change was made in this, in an earlier, or in a later version, then evaluate the second argument."

\newcommand{\ifthisversion}[2]{\IfStrEq{\thisversion}{#1}{#2}{}}
\newcommand{\ifearlierversion}[2]{\IfSubStr{\earlierversions}{#1}{#2}{}}
\newcommand{\iflaterversion}[2]{\IfSubStr{\earlierversions\thisversion}{#1}{}{#2}}

\newcommand{\added}[1]{{\color{blue} #1}}
\newcommand{\deleted}[1]{{\color{red} #1}}
\newcommand{\note}[1]{{\color{orange} [#1]}}

\IfStrEq{\thisversion}{All}{
    \newcommand{\addedin}[3]{%
        \note{Added in #1 by #2: \added{#3}}%
    }
    \newcommand{\deletedin}[3]{%
        \note{Deleted in #1 by #2: \deleted{#3}}%
    }
    \newcommand{\changedin}[4]{%
        \note{Changed in #1 by #2: \deleted{#3} \added{#4}}%
    }
    \newcommand{\notein}[2]{%
        \note{Note in #1: #2}%
    }
    \newcommand{\itemaddedin}[3]{%
        \added{\item \addedin{#1}{#2}{#3}}%
    }
    \newcommand{\itemdeletedin}[3]{%
        \deleted{\item \deletedin{#1}{#2}{#3}}%
    }
    \newcommand{\silentlyaddedin}[2]{#2}
}
{
\IfSubStr{\thissubversion}{Verbose Changes}{
    \newcommand{\addedin}[3]{%
        \ifthisversion{#1}{\note{Added in #1 by #2: \added{#3}}}%
        \ifearlierversion{#1}{#3}%
    }
    \newcommand{\deletedin}[3]{%
        \iflaterversion{#1}{#3}%
        \ifthisversion{#1}{\note{Deleted in #1 by #2: \deleted{#3}}}%
    }
    \newcommand{\changedin}[4]{%
        \iflaterversion{#1}{#3}%
        \ifthisversion{#1}{\note{Changed in #1 by #2: \deleted{#3} \added{#4}}}%
        \ifearlierversion{#1}{#4}%
    }
    \newcommand{\notein}[2]{%
        \ifthisversion{#1}{\note{Note in #1: #2}}%
    }
    \newcommand{\itemaddedin}[3]{%
        \ifthisversion{#1}{\added{\item \note{Added in #1 by #2: \added{#3}}}}%
        \ifearlierversion{#1}{\item #3}%
    }
    \newcommand{\itemdeletedin}[3]{%
        \ifthisversion{#1}{\deleted{\item \note{Deleted in #1 by #2: \deleted{#3}}}}%
        \iflaterversion{#1}{\item #3}%
    }
    \newcommand{\tablerownotein}[3]{%
        \ifthisversion{#1}{\multicolumn{#2}{l}{\note{Note in #1: #3}}\\}%
	}
    \newcommand{\silentlyaddedin}[2]{%
        \ifthisversion{#1}{#2}%
        \ifearlierversion{#1}{#2}%
    }
}{
\IfSubStr{\thissubversion}{Changes}{
    \newcommand{\addedin}[3]{%
        \ifthisversion{#1}{\added{#3}}%
        \ifearlierversion{#1}{#3}%
    }
    \newcommand{\deletedin}[3]{%
        \ifthisversion{#1}{\deleted{#3}}%
        \iflaterversion{#1}{#3}%
    }
    \newcommand{\changedin}[4]{%
        \iflaterversion{#1}{#3}%
        \ifthisversion{#1}{\deletedin{#1}{#2}{{#3}} \addedin{#1}{#2}{{#4}}}%
        \ifearlierversion{#1}{#4}%
    }
    \newcommand{\notein}[2]{%
        \ifthisversion{#1}{\note{#2}}%
    }
    \newcommand{\itemaddedin}[3]{%
        \ifthisversion{#1}{\added{\item #3}}%
        \ifearlierversion{#1}{\item #3}%
    }
    \newcommand{\itemdeletedin}[3]{%
        \ifthisversion{#1}{\deleted{\item #3}}%
        \iflaterversion{#1}{\item #3}%
    }
    \newcommand{\tablerownotein}[3]{%
        \ifthisversion{#1}{\multicolumn{#2}{l}{\note{#3}}\\}%
	}
    \newcommand{\silentlyaddedin}[2]{%
        \ifthisversion{#1}{#2}%
        \ifearlierversion{#1}{#2}%
    }
}{
    \newcommand{\addedin}[3]{%
        \ifthisversion{#1}{#3}%
        \ifearlierversion{#1}{#3}%
    }
    \newcommand{\deletedin}[3]{%
        \iflaterversion{#1}{#3}%
    }
    \newcommand{\changedin}[4]{%
        \deletedin{#1}{#2}{#3}\addedin{#1}{#2}{#4}%
    }
    \newcommand{\notein}[2]{%
    }
    \newcommand{\itemaddedin}[3]{%
        \ifthisversion{#1}{\item #3}%
        \ifearlierversion{#1}{\item #3}%
    }
    \newcommand{\itemdeletedin}[3]{%
        \iflaterversion{#1}{\item #3}%
    }
    \newcommand{\tablerownotein}[3]{%
	}
    \newcommand{\silentlyaddedin}[2]{%
        \ifthisversion{#1}{#2}%
        \ifearlierversion{#1}{#2}%
    }
}}}

\newcommand{\x}[2]{\changedin{2Z}{AWF}{#1}{#2}}
\newcommand{\xlc}[1]{\x{#1}{\MakeLowercase{#1}}}
\newcommand{\xuc}[1]{\x{#1}{\MakeUppercase{#1}}}
\newcommand{\xhyphen}[0]{\x{ }{-}}
\newcommand{\xAP}[1]{\x{#1}{AP}}
\newcommand{\xAPs}[1]{\x{#1}{APs}}
\newcommand{\xDP}[1]{\x{#1}{DP}}
\newcommand{\xDPs}[1]{\x{#1}{DPs}}
\newcommand{\xGT}[1]{\x{#1}{game turn}}
\newcommand{\xGTs}[1]{\x{#1}{game turns}}
