
% Use the full page with 1 cm margins.

\usepackage[
  paper=letterpaper,
  nofoot,nomarginpar,
  includehead,
  margin=1cm
]{geometry}

% Use TeX Gyre Schola for text and math.

\usepackage[T1]{fontenc}
\usepackage{unicode-math}
\setmainfont{TeX Gyre Schola}
\setmathfont{TeX Gyre Schola Math}

\usepackage{titlesec}
\usepackage{titletoc}
\usepackage{fancyhdr}
\usepackage{enumitem}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{xcolor}
\usepackage{tabularx}
\usepackage{multicol}
\usepackage{microtype}
\usepackage{multirow}
\usepackage{pdflscape}

% Basic spacing.

\setlength{\columnsep}{2em}

\setlength{\parindent}{0em}
\setlength{\parskip}{0.8ex plus 0.1ex}
\newcommand{\numberspace}{\phantom{0}}

\newlength{\fitwidthwidth}
\newsavebox{\fitwidthbox}
\newenvironment{fitwidth}[1]{%
    \setlength{\fitwidthwidth}{#1}%
    \begin{lrbox}{\fitwidthbox}%
}{%
    \end{lrbox}%
    \resizebox{\the\fitwidthwidth}{!}{\usebox{\fitwidthbox}}%
}

% Headers

\newcommand{\therunningtitle}{}
\newcommand{\runningtitle}[1]{\renewcommand{\therunningtitle}{#1}}

\pagestyle{fancy}
\setlength{\headsep}{1em}
\fancyhead[L]{\textbf{\therunningtitle}}
\fancyhead[C]{}
\fancyhead[R]{\textbf{Page \thepage}}
\fancyfoot[L,C,R]{}
\setlength{\footskip}{4pt}
\renewcommand{\headruleskip}{0.1em}
\addtolength{\headheight}{\headruleskip}

% Line weights

\setlength{\arrayrulewidth}{0.4pt}
\setlength{\columnseprule}{0.4pt}
\renewcommand{\headrulewidth}{0.4pt}

% Lists

\setlist[itemize]{
  label=--,
  leftmargin=1.5em,
  rightmargin=1.5em,
  nosep,
  parsep=\parskip
}
\setlist[enumerate]{
  leftmargin=1.5em,
  rightmargin=1.5em,
  nosep,
  parsep=\parskip
}

\newcommand{\itemparagraph}[1]{{\bfseries #1}}

% Tables

%\newcommand{\minitable}[2][l]{\begin{tabular}{@{}#1@{}}#2\end{tabular}}
\newcommand{\minitable}[3][c]{\begin{tabular}[#1]{@{}#2@{}}#3\end{tabular}}
\newcommand*\rot{\rotatebox{90}}

% Add a little bit of space after \hline
\let\originalhline\hline
\renewcommand{\hline}{\originalhline\\[-1em]}

\newcommand{\tablesmallskip}{\\[-1.5ex]}
\newcommand{\tablemedskip}{\\[-1.0ex]}

\newcommand{\tablenotes}[3]{%
  \multicolumn{#1}{l}{\begin{minipage}{#2}#3\end{minipage}}\\
}

% Sections

\setcounter{secnumdepth}{3}

\newcommand{\beforesectionnumber}{}
\newcommand{\aftersectionnumber}{}
\newcommand{\beforesubsectionnumber}{}
\newcommand{\aftersubsectionnumber}{}
\newcommand{\beforesubsubsectionnumber}{}
\newcommand{\aftersubsubsectionnumber}{}

\titleformat{\section}
    [block]
    {\filcenter\large\bfseries}
    {\beforesectionnumber\thesection\aftersectionnumber}
    {\wordsep}
    {\MakeUppercase}
\titlespacing{\section}{0pt}{2.4ex plus .1ex minus .1ex}{1.3ex minus .1ex}

\titleformat{\subsection}
    {\filright\bfseries}
    {\beforesubsectionnumber\thesubsection\aftersubsectionnumber}
    {\wordsep}
    {\MakeUppercase}
\titlespacing{\subsection}{0pt}{1.8ex plus .1ex minus .1ex}{0.3ex minus .1ex}

\titleformat{\subsubsection}
    {\filright\bfseries\itshape}
    {\beforesubsubsectionnumber\thesubsubsection\aftersubsubsectionnumber}
    {\wordsep}
    {\MakeUppercase}
\titlespacing{\subsubsection}{0pt}{1.2ex plus .1ex minus .1ex}{0.3ex minus .1ex}

\newcommand{\afterparagraphtitle}{}
\titleformat{\paragraph}[runin]{\bfseries}{}{0.5em}{}[\afterparagraphtitle]
\titlespacing{\paragraph}{0em}{0em}{\wordsep}

\newcommand{\advancedrules}{
  \vspace{1ex}
  \begin{center}
    \bfseries{ADVANCED RULES}
  \end{center}
  \vspace{0.5ex}
}

\newcommand{\trainingnote}[1]{
  \vspace{1ex}
  \begin{center}
    \framebox{\begin{minipage}{0.9\linewidth} #1\end{minipage}}
  \end{center}
  \vspace{1ex}
}

% Captions

\newcommand{\tablecaption}[1]{
  \centering
  \caption{#1}
  \medskip
}

% Style for the standard title page

\let\originaltitle\title
\renewcommand{\title}[1]{\originaltitle{\bfseries\Large\MakeUppercase{#1}}}
\let\originalauthor\author
\renewcommand{\author}[1]{\originalauthor{\itshape\normalsize{#1}}}
\let\originaldate\date
\renewcommand{\date}[1]{\originaldate{\normalsize{#1}}}

% Abbreviations

\newcommand{\AirSup}{\itshape Air Superiority}
\newcommand{\AirStr}{\itshape Air Strike}
\newcommand{\DF}{\itshape Desert Falcons}
\newcommand{\EOTG}{\itshape Eagles of the Gulf}
\newcommand{\TSOH}{\itshape The Speed of Heat}
\newcommand{\AirPow}{\itshape Air Power}
\newcommand{\APJ}{\itshape Air Power Journal}

\newcommand{\FP}  {\text{FP}}
\newcommand{\FPs} {\text{FPs}}
\newcommand{\HFP} {\text{HFP}}
\newcommand{\HFPs}{\text{HFPs}}
\newcommand{\VFP} {\text{VFP}}
\newcommand{\VFPs}{\text{VFPs}}
\newcommand{\CC}  {\text{CC}}

\newcommand{\onethird}{$1/3$}
\newcommand{\onehalf}{$1/2$}
\newcommand{\twothirds}{$2/3$}

\renewcommand{\deg}{\ensuremath{^\circ}}

% Figures

\usepackage{tikz}
\usetikzlibrary{calc}
\usetikzlibrary{arrows.meta}

\newenvironment{tikzfigure}[1]{%
    \begin{fitwidth}{#1}%
    \begin{tikzpicture}[>={Stealth[length=1.5mm,inset=0pt]}]%
    \scriptsize%
}{%
    \end{tikzpicture}%
    \end{fitwidth}%
}

\newcommand{\drawaircraftcounter}[5]{
    \begin{athex}{#1}{#2}
        \begin{scope}[rotate=#3-45]
            \draw[fill=white] (-0.3,-0.3) rectangle (0.3,0.3);
            \node [anchor=center,rotate=#3] {
                \includegraphics[angle=0,width=0.6cm]{plan-views/#4.png}
            };
            \node [anchor=south east,rotate=#3-45] at (+0.3,-0.3) {\tiny #5};
        \end{scope}
    \end{athex}
}

\newcommand{\drawdashedcounter}[3]{
    \begin{athex}{#1}{#2}
        \begin{scope}[rotate=#3-45]
            \draw[dashed,fill=white] (-0.3,-0.3) rectangle (0.3,0.3);
        \end{scope}
    \end{athex}
}

\newcommand{\hexxfactor}{0.866}

\newenvironment{athex}[2]{
    \begin{scope}[shift={(#1*\hexxfactor,#2)}]
}{
    \end{scope}
}
\newcommand{\miniathex}[3]{\begin{athex}{#1}{#2}#3\end{athex}}

\newcommand{\drawhex}[3][white]{
    \begin{athex}{#2}{#3}
        \begin{scope}[xscale=\hexxfactor]
            \draw [fill=#1] (+0.667,+0.000) -- (+0.333,+0.500) -- (-0.333,+0.500) -- (-0.667,+0.000) -- (-0.333,-0.500) -- (+0.333,-0.500) -- cycle;
        \end{scope}
    \end{athex}
}

\newcommand{\drawmegahex}[2]{
    \begin{athex}{#1}{#2}
        \begin{scope}[yscale=5,xscale=5*\hexxfactor,line width=2,color=black!50]
            \draw (+0.667,+0.000) -- (+0.333,+0.500) -- (-0.333,+0.500) -- (-0.667,+0.000) -- (-0.333,-0.500) -- (+0.333,-0.500) -- cycle;
        \end{scope}
    \end{athex}
}

\newcommand{\drawhexgrid}[2]{
    \clip (0,0) rectangle (#1*\hexxfactor,#2);
    \foreach \x in {0,2,...,#1} {
        \foreach \y in {0,1,...,#2} {
            \miniathex{0.0}{0.0}{\drawhex{\x}{\y}}
            \miniathex{1.0}{0.5}{\drawhex{\x}{\y}}
        }
    }
}
